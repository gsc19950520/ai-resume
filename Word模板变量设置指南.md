# Word动态模板变量设置与使用指南

本指南详细说明如何在Word模板中设置动态变量，以便系统能正确渲染包含个人信息、教育经历、工作经历等内容的简历。

## 一、变量类型及语法

系统支持三种类型的动态元素：

### 1. 单变量替换

**语法格式：** `{{变量名}}`

用于替换单个文本内容，如姓名、电话等。

### 2. 循环结构

**语法格式：** 
```
{{#each 列表名}}
循环内容，可使用{{item.字段名}}访问每个元素的属性
{{/each}}
```

用于重复渲染列表数据，如教育经历、工作经历等。

### 3. 条件结构

**语法格式：** 
```
{{#if 条件表达式}}
条件成立时显示的内容
{{/if}}
```

用于根据条件显示或隐藏内容。

## 二、可用变量列表

### 1. 基本个人信息变量

| 变量名 | 说明 | 示例 |
|--------|------|------|
| `{{name}}` | 姓名 | 张三 |
| `{{phone}}` | 电话 | 138****1234 |
| `{{email}}` | 邮箱 | example@domain.com |
| `{{address}}` | 地址 | 北京市海淀区 |
| `{{birthDate}}` | 出生日期 | 1990-01-01 |
| `{{jobType}}` | 求职意向/应聘职位 | 前端开发工程师 |
| `{{selfIntroduction}}` | 个人评价/自我介绍 | 五年前端开发经验... |

### 2. 专业技能变量

| 变量名 | 说明 | 示例 |
|--------|------|------|
| `{{skills}}` | 专业技能（字符串，通常以逗号分隔） | HTML5, CSS3, JavaScript, React, Vue |

### 3. 教育经历列表变量 (educationList)

**列表项字段：**

| 字段名 | 说明 | 示例 |
|--------|------|------|
| `{{item.school}}` | 学校名称 | 北京大学 |
| `{{item.major}}` | 专业名称 | 计算机科学与技术 |
| `{{item.degree}}` | 学历 | 本科 |
| `{{item.startDate}}` | 开始时间 | 2016-09 |
| `{{item.endDate}}` | 结束时间 | 2020-06 |
| `{{item.description}}` | 备注/描述 | 获得优秀毕业生称号 |

### 4. 工作经历列表变量 (workExperienceList)

**列表项字段：**

| 字段名 | 说明 | 示例 |
|--------|------|------|
| `{{item.company}}` | 公司名称 | ABC科技有限公司 |
| `{{item.position}}` | 职位 | 前端开发工程师 |
| `{{item.startDate}}` | 开始时间 | 2020-07 |
| `{{item.endDate}}` | 结束时间 | 2023-03 |
| `{{item.description}}` | 工作描述 | 负责公司官网开发... |

## 三、Word模板设置示例

### 1. 基本个人信息部分示例

在Word模板中，可以这样设置个人信息区域：

```
# {{name}}
求职意向：{{jobType}}

联系方式：
电话：{{phone}}
邮箱：{{email}}
地址：{{address}}
{{#if birthDate}}
出生日期：{{birthDate}}
{{/if}}
```

### 2. 个人评价部分示例

```
## 个人评价
{{selfIntroduction}}
```

### 3. 专业技能部分示例

```
## 专业技能
{{skills}}
```

### 4. 教育经历部分示例（循环结构）

```
## 教育经历
{{#each educationList}}
- {{item.school}} | {{item.major}} | {{item.degree}}
  {{item.startDate}} - {{item.endDate}}
  {{#if item.description}}
  备注：{{item.description}}
  {{/if}}
{{/each}}
```

### 5. 工作经历部分示例（循环结构）

```
## 工作经历
{{#each workExperienceList}}
- {{item.company}} | {{item.position}}
  {{item.startDate}} - {{item.endDate}}
  {{item.description}}
{{/each}}
```

## 四、修改现有Word模板步骤

1. **打开现有Word模板**：
   - 找到项目中的Word模板文件（通常位于`ai-resume-service`目录下，如`template_one.docx`等）
   - 使用Microsoft Word或其他兼容软件打开模板文件

2. **确定需要插入动态变量的位置**：
   - 识别模板中需要动态替换的文本，如姓名、联系方式等
   - 找到需要循环展示数据的区域，如教育经历列表、工作经历列表

3. **插入动态变量**：
   - 直接在文档中输入相应的变量语法，例如将"张三"替换为`{{name}}`
   - 对于列表区域，使用循环语法`{{#each 列表名}}...{{/each}}`包裹列表项模板

4. **添加条件判断**（可选）：
   - 对于可能为空的字段，使用条件语法`{{#if 变量名}}...{{/if}}`进行包裹
   - 例如：`{{#if birthDate}}出生日期：{{birthDate}}{{/if}}`

5. **保存模板**：
   - 保持原文件名或另存为新的模板文件
   - 确保文件格式为`.docx`

## 五、注意事项

1. **变量拼写必须完全正确**，包括大小写
2. **循环结构和条件结构必须成对出现**，有开始标记`{{#each}}`、`{{#if}}`就必须有结束标记`{{/each}}`、`{{/if}}`
3. **在循环内部访问字段时，必须使用`item.字段名`的格式**
4. **对于较长的工作描述或个人评价，建议保留适当的行间距**
5. **在Word中编辑时，避免使用复杂的格式或样式嵌套**，可能会影响变量替换效果

## 六、测试模板

修改完成后，可以通过以下方式测试模板：

1. 使用项目中的简历编辑功能填写一份测试简历
2. 生成PDF或Word文档
3. 检查生成的文档是否正确替换了所有变量，特别是循环区域是否正确渲染了多条数据

如有任何问题，可以根据错误信息调整模板中的变量设置。