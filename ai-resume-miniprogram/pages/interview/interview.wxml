<!-- interview.wxml -->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="header">
    <view class="header-left" bindtap="goBack">
      <view class="job-badge">{{industryJobTag || 'æŠ€æœ¯é¢è¯•'}}</view>
    </view>
    <view class="header-center">AI æ¨¡æ‹Ÿé¢è¯•</view>
    <view class="header-right">
      <view class="progress-area">
        <view class="countdown-timer {{sessionTimeRemaining < 60 ? 'time-warning pulse' : ''}}">
            {{formattedTimeRemaining}}
          </view>
        <view class="progress-bar">
          <view 
            class="progress-fill"
            style="width: {{(sessionTimeRemaining / sessionSeconds) * 100}}%"
          ></view>
        </view>
      </view>
    </view>
  </view>

  

  <!-- ä¸»å†…å®¹åŒºåŸŸ -->
  <view class="main-content">
    <!-- å·¦ä¾§ï¼šAIé—®é¢˜å¡ç‰‡ -->
    <view class="left-column">
      <view class="question-card-wrapper" wx:if="{{!showFeedback}}">
        <!-- åŠ è½½ä¸­æç¤ºï¼šä»…å½“isLoadingä¸ºtrueä¸”questionå’ŒnextQuestionéƒ½ä¸ºç©ºæ—¶æ˜¾ç¤º -->
        <view class="loading-container" wx:if="{{isLoading && question === '' && nextQuestion === ''}}">
          <view class="loading-spinner"></view>
          <view class="loading-text">é¢˜ç›®æ­£åœ¨ç”Ÿæˆä¸­...</view>
        </view>
        <!-- é—®é¢˜å¡ç‰‡ï¼šå½“questionä¸ä¸ºç©ºæˆ–nextQuestionä¸ä¸ºç©ºæ—¶æ˜¾ç¤º -->
        <view class="question-card {{animationState.questionCard !== 'idle' ? 'fade-in-bottom' : ''}}" wx:if="{{question !== '' || nextQuestion !== ''}}">
          <view class="question-content">{{isLoading ? nextQuestion : question}}</view>
          <!-- æç¤ºä¿¡æ¯å·²ç§»é™¤ï¼Œæ ¹æ®æ–°çš„æ•°æ®ç»“æ„ -->
        </view>
      </view>
    </view>

    <!-- å³ä¾§ï¼šç”¨æˆ·å›ç­”é¢æ¿å’ŒAIåé¦ˆå¡ç‰‡ -->
    <view class="right-column">
      <!-- ç­”é¢˜é¢æ¿ - AnswerPanel -->
      <view class="user-answer-panel">
        <view class="panel-header">
          <view class="panel-title">è¯·å›ç­”</view>
        </view>

        <!-- å›ç­”è¾“å…¥åŒºåŸŸ -->
        <view class="answer-input-area">
          <textarea 
            class="answer-textarea" 
            placeholder="è¯·è¾“å…¥æ‚¨çš„å›ç­”..."
            value="{{userAnswer}}"
            bindinput="onUserAnswerInput"
            auto-height
            maxlength="1000"
          ></textarea>
        </view>

        <!-- æäº¤è¡Œ -->
        <view class="submit-row">
          <button 
            class="submit-btn-primary"
            bindtap="submitAnswer"
            disabled="{{userAnswer === null || userAnswer === undefined || userAnswer.trim() === '' }}"
          >
            æäº¤å›ç­”
          </button>
        </view>
      </view>

      <!-- é—®ç­”è®°å½•åˆ—è¡¨ - InterviewHistoryList -->
      <view class="interview-history-list fade-in" wx:if="true">
        <view class="history-list-header">
          <view class="history-list-title">é—®ç­”è®°å½•</view>
          <view class="history-list-count">å…± {{interviewHistory.length}} æ¡</view>
        </view>
        
        <scroll-view class="history-list-content" id="history-list-content" scroll-y="true" scroll-into-view="{{scrollIntoView}}">
          <view wx:for="{{interviewHistory}}" wx:key="id" class="history-list-item" id="{{item.id}}">
            <!-- é—®é¢˜è®°å½• -->
            <view class="question-block" wx:if="{{item.type === 'question'}}">
              <view class="block-header">
                <view class="block-icon question-icon">
                  <image src="/images/avatar.jpg" mode="aspectFit"></image>
                </view>
                <view class="block-title">é¢è¯•å®˜</view>
                <view class="block-time">{{item.formattedTime}}</view>
              </view>
              <view class="question-content">{{item.content}}</view>
            </view>
            
            <!-- å›ç­”è®°å½• -->
            <view class="answer-block" wx:if="{{item.type === 'answer'}}">
              <view class="block-header">
                <view class="block-icon answer-icon">ğŸ‘¤</view>
                <view class="block-title">æ‚¨çš„å›ç­”</view>
                <view class="block-time">{{item.formattedTime}}</view>
              </view>
              <view class="answer-content">{{item.content}}</view>
            </view>
          </view>
        </scroll-view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ§åˆ¶æŒ‰é’® -->
  <view class="footer-controls">
    <button 
      class="footer-btn footer-btn-warning"
      bindtap="togglePause"
    >
      {{isPaused ? 'ç»§ç»­' : 'æš‚åœ'}}
    </button>
    <button 
      class="footer-btn footer-btn-primary"
      bindtap="finishInterview"
    >
      ç»“æŸå¹¶ç”ŸæˆæŠ¥å‘Š
    </button>
  </view>

  <!-- æ—¶é—´è­¦å‘Šè¦†ç›–å±‚ -->
  <view class="time-warning-overlay" wx:if="{{showTimeWarningOverlay}}">
    <view class="warning-content">
      <view class="warning-icon">âš ï¸</view>
      <view class="warning-text">é¢è¯•å³å°†ç»“æŸ</view>
      <view class="warning-time">{{formatRemainingTime(sessionTimeRemaining)}}</view>
    </view>
  </view>
</view>