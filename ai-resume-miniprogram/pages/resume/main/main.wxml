<!-- ç®€å†ä¸»é¡µé¢ -->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">æ­£åœ¨åŠ è½½ç®€å†ä¿¡æ¯...</text>
  </view>

  <!-- æœ‰ç®€å†æ—¶æ˜¾ç¤ºç®€å†å†…å®¹ -->
  <view class="resume-container" wx:elif="{{hasResume}}">
    <!-- å¤´éƒ¨ -->
    <view class="header">
      <text class="title">æˆ‘çš„ç®€å†</text>
      <text class="subtitle">{{ resumeData && resumeData.title ? resumeData.title : 'æœªå‘½åç®€å†' }}</text>
    </view>

    <!-- ç®€å†å†…å®¹åŒºåŸŸ -->
    <scroll-view class="resume-content" scroll-y>
      <!-- ç®€å†å†…å®¹å®¹å™¨ -->
      <view class="resume-content-wrapper {{templateClass}}">
        <!-- å¦‚æœæœ‰åç«¯æ¸²æŸ“çš„HTMLï¼Œä¼˜å…ˆæ˜¾ç¤º -->
        <rich-text wx:if="{{resumeData && resumeData.renderedHtml}}" nodes="{{resumeData.renderedHtml}}"></rich-text>
        
        <!-- å¦åˆ™æ˜¾ç¤ºæ¨¡æ¿åŒ–çš„ç®€å†å†…å®¹ -->
        <view wx:else class="template-resume">
          <!-- ä¸ªäººä¿¡æ¯ -->
          <view class="personal-info" wx:if="{{resumeData.personalInfo}}">
            <text class="name">{{resumeData.personalInfo.name || 'å§“å'}}</text>
            <text class="job-title">{{resumeData.personalInfo.jobTitle || 'èŒä½'}}</text>
            <view class="contact-info">
              <text wx:if="{{resumeData.personalInfo.phone}}">{{resumeData.personalInfo.phone}}</text>
              <text wx:if="{{resumeData.personalInfo.email}}">{{resumeData.personalInfo.email}}</text>
              <text wx:if="{{resumeData.personalInfo.address}}">{{resumeData.personalInfo.address}}</text>
            </view>
          </view>

          <!-- ä¸ªäººæ¦‚è¿° -->
          <view class="section" wx:if="{{resumeData.summary}}">
            <text class="section-title">ä¸ªäººæ¦‚è¿°</text>
            <text class="section-content">{{resumeData.summary}}</text>
          </view>

          <!-- å·¥ä½œç»å† -->
          <view class="section" wx:if="{{resumeData.workExperience && resumeData.workExperience.length > 0}}">
            <text class="section-title">å·¥ä½œç»å†</text>
            <view class="experience-list">
              <view class="experience-item" wx:for="{{resumeData.workExperience}}" wx:key="index">
                <view class="experience-header">
                  <text class="company">{{item.company || 'å…¬å¸åç§°'}}</text>
                  <text class="period">{{item.period || 'æ—¶é—´æ®µ'}}</text>
                </view>
                <text class="position">{{item.position || 'èŒä½'}}</text>
                <text class="description">{{item.description || 'å·¥ä½œæè¿°'}}</text>
              </view>
            </view>
          </view>

          <!-- æ•™è‚²ç»å† -->
          <view class="section" wx:if="{{resumeData.education && resumeData.education.length > 0}}">
            <text class="section-title">æ•™è‚²ç»å†</text>
            <view class="education-list">
              <view class="education-item" wx:for="{{resumeData.education}}" wx:key="index">
                <view class="education-header">
                  <text class="school">{{item.school || 'å­¦æ ¡åç§°'}}</text>
                  <text class="period">{{item.period || 'æ—¶é—´æ®µ'}}</text>
                </view>
                <text class="degree-major">{{item.degree || ''}} {{item.major || ''}}</text>
              </view>
            </view>
          </view>

          <!-- æŠ€èƒ½ -->
          <view class="section" wx:if="{{resumeData.skills && resumeData.skills.length > 0}}">
            <text class="section-title">æŠ€èƒ½</text>
            <view class="skills-list">
              <text class="skill-tag" wx:for="{{resumeData.skills}}" wx:key="index">{{item}}</text>
            </view>
          </view>
        </view>
      </view>
    </scroll-view>

    <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
    <view class="footer">
      <button class="edit-btn" bindtap="editResume">
        ç¼–è¾‘ç®€å†
      </button>
      <button class="share-btn" bindtap="shareResume">
        åˆ†äº«
      </button>
      <button class="pdf-btn" bindtap="exportToPdf">
        å¯¼å‡ºä¸ºPDF
      </button>
    </view>
  </view>

  <!-- æ— ç®€å†æ—¶æ˜¾ç¤ºæ¨¡æ¿åˆ—è¡¨ -->
  <view class="template-list-container" wx:elif="{{isLoggedIn}}">
    <view class="empty-state">
      <view class="empty-icon">ğŸ“„</view>
      <text class="empty-text">æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºç®€å†</text>
      <text class="empty-subtext">é€‰æ‹©ä¸€ä¸ªæ¨¡æ¿å¼€å§‹åˆ›å»ºæ‚¨çš„ä¸“ä¸šç®€å†</text>
    </view>
    
    <!-- æ¨¡æ¿åˆ—è¡¨ - å·¦å³ä¸¤åˆ—ç½‘æ ¼å¸ƒå±€ -->
    <!-- ä½¿ç”¨pageReadyçŠ¶æ€æ§åˆ¶æ¸²æŸ“ï¼Œç¡®ä¿é¡µé¢å®Œå…¨å°±ç»ªåå†æ¸²æŸ“å†…å®¹ -->
    <view wx:if="{{pageReady}}" class="template-grid">
      <view class="template-card" wx:for="{{templateList}}" wx:key="id">
          <!-- æ¨¡æ¿å¡ç‰‡å®¹å™¨ - ç‚¹å‡»æ•´ä¸ªå¡ç‰‡ç›´æ¥è¿›å…¥æ¨¡æ¿ -->
          <view class="template-wrapper" bindtap="selectTemplate" data-id="{{item.id}}" data-name="{{item.name}}">
            <!-- ç¼©ç•¥å›¾åŒºåŸŸ - åªæ˜¾ç¤ºæ¨¡æ¿å°å›¾ -->
            <view class="thumbnail-container">
              <!-- ä½¿ç”¨æ¡ä»¶æ¸²æŸ“æ§åˆ¶å›¾ç‰‡åŠ è½½ï¼Œé¿å…æå‰æ¸²æŸ“ -->
              <image class="template-thumbnail" 
                     src="{{item.preview || '/images/template-one.jpg'}}" 
                     mode="aspectFill" 
                     wx:if="{{item.preview}}">
              </image>
              <!-- å½“å›¾ç‰‡è¿˜æœªåŠ è½½æ—¶æ˜¾ç¤ºä¸€ä¸ªå ä½å…ƒç´  -->
              <view class="thumbnail-placeholder" wx:else>
                <!-- å ä½å…ƒç´ ï¼Œä¸å›¾ç‰‡å¤§å°ä¸€è‡´ -->
              </view>
              <view wx:if="{{item.vipOnly}}" class="vip-badge">VIPä¸“äº«</view>
              <view wx:if="{{item.isFree}}" class="free-badge">å…è´¹</view>
            </view>
          </view>
        </view>
    </view>
    
    <!-- é¡µé¢æœªå°±ç»ªæ—¶æ˜¾ç¤ºç©ºç™½å ä½ï¼Œé¿å…é—ªçƒ -->
    <view wx:else class="template-grid-placeholder">
      <!-- ç©ºç™½å ä½å…ƒç´ ï¼Œä¸å®é™…å†…å®¹ä¿æŒç›¸åŒçš„ç»“æ„å’Œå¸ƒå±€å ä½ -->
      <view class="template-card-placeholder"></view>
      <view class="template-card-placeholder"></view>
      <view class="template-card-placeholder"></view>
      <view class="template-card-placeholder"></view>
      <view class="template-card-placeholder"></view>
      <view class="template-card-placeholder"></view>
    </view>
  </view>
  
  <!-- æœªç™»å½•æ—¶æ˜¾ç¤ºç™»å½•æç¤º -->
  <view class="login-prompt-container" wx:else>
    <view class="login-state">
      <view class="login-icon">ğŸ”’</view>
      <text class="login-text">è¯·å…ˆç™»å½•</text>
      <text class="login-subtext">ç™»å½•åå³å¯åˆ›å»ºå’Œç®¡ç†æ‚¨çš„ç®€å†</text>
      <button class="login-btn" type="primary" bindtap="showLoginTip">
        ç«‹å³ç™»å½•
      </button>
    </view>
  </view>
    

    <!-- <view class="action-buttons">
      <button class="create-btn" type="primary" bindtap="createResume">
        ç«‹å³åˆ›å»ºç®€å†
      </button>
    </view> -->
</view>
