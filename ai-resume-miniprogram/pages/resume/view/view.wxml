<!-- 简历预览页面 -->
<view class="container">
  <!-- 头部 -->
  <view class="header">
    <text class="title">简历预览</text>
    <text class="subtitle">{{ resumeData && resumeData.title ? resumeData.title : '未命名简历' }}</text>
    <view class="ai-badge" wx:if="{{ source === 'ai' }}">
      <text class="ai-text">AI 生成</text>
    </view>
  </view>

  <!-- 简历内容区域 -->
  <scroll-view class="resume-content" scroll-y>
    <!-- 简历内容容器 -->
    <view class="resume-content-wrapper">
      <!-- 加载中状态 -->
      <view class="loading-state" wx:if="{{loading}}">
        <view class="loading-spinner"></view>
        <text class="loading-text">正在应用模板样式...</text>
      </view>
      
      <!-- 如果有后端渲染的HTML，优先显示 -->
      <rich-text wx:elif="{{renderedHtml}}" nodes="{{renderedHtml}}"></rich-text>
      
      <!-- 空状态 -->
      <view class="empty-state" wx:else>
        <view class="empty-icon">📄</view>
        <text class="empty-text">暂无简历内容或模板渲染失败</text>
        <button class="edit-btn" bindtap="editResume">去编辑简历</button>
        <button class="edit-btn secondary" bindtap="selectTemplate">选择模板</button>
      </view>
    </view>
  </scroll-view>

  <!-- 底部操作按钮 -->
  <view class="footer">
    <button class="edit-btn" bindtap="editResume">
      {{source === 'ai' ? '重新生成' : '继续编辑'}}
    </button>
    <button class="save-btn" type="primary" bindtap="saveToMyResumes">
      保存到我的简历
    </button>
    <button class="share-btn" open-type="share">
      分享
    </button>
    <button class="use-template-btn" style="width: 600rpx; height: 90rpx; line-height: 90rpx; background: linear-gradient(135deg, #3498db, #2980b9); color: white; font-size: 32rpx; font-weight: bold; border-radius: 45rpx; box-shadow: 0 4rpx 12rpx rgba(52, 152, 219, 0.3); display: flex; align-items: center; justify-content: center; border: none; margin: 20rpx auto 0;" bindtap="exportToPdf">
      导出为PDF
    </button>
  </view>
</view>